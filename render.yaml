services:
  # -----------------------------
  # BACKEND SERVICE (Dockerized)
  # -----------------------------
  - type: web
    name: micro-ops-backend
    env: docker
    plan: free
    rootDir: .                     # Set context to root so it sees package.json
    dockerfilePath: ./docker/Dockerfile.prod # Point to your specific backend file
    healthCheckPath: /health
    envVars:
      - key: PORT
        value: 8000                # Matches the internal port your backend likely uses
      # Add S3, Sentry, OTel keys in the Render Dashboard!

  # -----------------------------
  # FRONTEND SERVICE (Dockerized)
  # -----------------------------
  - type: web
    name: micro-ops-frontend
    env: docker
    plan: starter                  # Docker frontends are NOT free (requires Starter plan)
    rootDir: .                     # Set context to root
    dockerfilePath: ./docker/Dockerfile.frontend # Point to your specific frontend file
    envVars:
      - key: PORT
        value: 80                  # Nginx usually listens on port 80 inside the container
      # You will need to add VITE_API_URL here pointing to your backend URL